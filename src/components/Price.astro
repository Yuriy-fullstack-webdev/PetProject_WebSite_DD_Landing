---
import { Image } from "astro:assets";
import HeaderBlock from "./blocks/HeaderBlock.astro";

const HeaderData = [
  {
    title: "Ціни на Дизайн/Розробку",
    subtitle:
      "Наші ціни на дизайн і розробку сайтів вигідні кожному з вас завдяки оптимальному поєднанню високої якості, індивідуального підходу та ефективних робочих процесів, що дозволяє нам пропонувати конкурентоспроможні розцінки.",
    color: "white", // Необязательный, с дефолтом "white" | "black";
    position: "center", // Необязательный, с дефолтом "left" | "center";
  },
];

const price = [
  {
    id: "design",
    title: "дизайн",
    imgSrc: "/src/assets/images/design-img.png",
    alt: "icon design",
    desc: [
      {
        title: "Лендинг/Односторінковий сайт",
        text: "Розробка концепції, UI/UX дизайн, візуальний дизайн, адаптивний дизайн (під різні пристрої), базові макети.",
        price: 6000,
      },
      {
        title: "Сайт-візитка/Корпоративний сайт (до 10 сторінок)",
        text: "Розробка концепції, UI/UX дизайн основних сторінок (головна, про компанію, послуги, контакти тощо), візуальний дизайн, адаптивний дизайн, макети всіх сторінок, базова анімація (за потреби).",
        price: 15000,
      },
      {
        title: "Складний / Кастомний сайт",
        text: "Індивідуальна розробка концепції, глибокий UI/UX аналіз, розробка складної структури та функціоналу, унікальний візуальний дизайн, розширена анімація та інтерактив, адаптивний дизайн, детальні макети всіх сторінок та елементів. Може включати прототипування високої точності.",
        price: 75000,
      },
      {
        title: "Інтернет-магазин (базовий функціонал)",
        text: "Розробка концепції, UI/UX дизайн основних сторінок (головна, каталог товарів, картка товару, кошик, оформлення замовлення, особистий кабінет тощо), візуальний дизайн, адаптивний дизайн, макети всіх ключових сторінок, дизайн елементів управління (кнопки, форми тощо).",
        price: 25000,
      },
    ],
  },
  {
    id: "dev",
    title: "розробка",
    imgSrc: "/src/assets/images/dev-img.png",
    alt: "icon dev",
    desc: [
      {
        title: "Лендинг/Промо-сайт",
        text: "Розробка концепції, UI/UX дизайн, візуальний дизайн, адаптивний дизайн (під різні пристрої), базові макети.",
        info: ["Кількість сторінок: 1-3 (приблизна)", "Кількість сторінок: 1-3 (приблизна)"],
        stack: ["CMS Wordpress", "CMS Wordpress"],
        price: ["6000", "6000"],
      },
      {
        title: "Сайт-візитка/Корпоративний сайт (до 10 сторінок)",
        text: "Розробка концепції, UI/UX дизайн основних сторінок (головна, про компанію, послуги, контакти тощо), візуальний дизайн, адаптивний дизайн, макети всіх сторінок, базова анімація (за потреби).",
        info: ["Кількість сторінок: 1-3 (приблизна)", "Кількість сторінок: 1-3 (приблизна)"],
        stack: ["CMS Wordpress", "CMS Wordpress"],
        price: ["6000", "6000"],
      },
      {
        title: "Складний / Кастомний сайт",
        text: "Індивідуальна розробка концепції, глибокий UI/UX аналіз, розробка складної структури та функціоналу, унікальний візуальний дизайн, розширена анімація та інтерактив, адаптивний дизайн, детальні макети всіх сторінок та елементів. Може включати прототипування високої точності.",
        info: ["Кількість сторінок: 1-3 (приблизна)", "Кількість сторінок: 1-3 (приблизна)"],
        stack: ["CMS Wordpress", "CMS Wordpress"],
        price: ["6000", "6000"],
      },
      {
        title: "Інтернет-магазин (базовий функціонал)",
        text: "Розробка концепції, UI/UX дизайн основних сторінок (головна, каталог товарів, картка товару, кошик, оформлення замовлення, особистий кабінет тощо), візуальний дизайн, адаптивний дизайн, макети всіх ключових сторінок, дизайн елементів управління (кнопки, форми тощо).",
        info: ["Кількість сторінок: 1-3 (приблизна)", "Кількість сторінок: 1-3 (приблизна)"],
        stack: ["CMS Wordpress", "CMS Wordpress"],
        price: ["6000", "6000"],
      },
    ],
  },
];
// Виділяємо окремі секції, щоб уникнути подвійного рендерингу всього масиву
const designSection = price.find((item) => item.id === "design");
const devSection = price.find((item) => item.id === "dev");
---

<section id="price" class="price">
  <div class="container">
    <HeaderBlock data={HeaderData} />
    <main class="main">
      <section class="price-header">
        {
          price.map((item) => (
            <div class:list={["price-header__item", `price-header__item-${item.id}`]}>
              <h3 class:list={["header-item", `${item.id}--color`]}>{item.title}</h3>
              <Image class="header-img" src={item.imgSrc} alt={item.alt} width={44} height={44} />
            </div>
          ))
        }
      </section>
      <section class="price-main">
        <ul class="price-list">
          {
            designSection &&
              designSection.desc.map((item) => (
                <li class="price-list__item">
                  <h4 class:list={["price-list__item-title", "design--color"]}>{item.title}</h4>
                  <div class="price-list__item-content">
                    <div class:list={["item-content", "design-content"]}>
                      <p class="item-content__desc">{item.text}</p>
                    </div>
                    <ul class="item-content__tariff">
                      <li class="item-content__tariff-item">
                        <p class="tariff-item__price">
                          <span>від&nbsp;</span>
                          <strong>{item.price}</strong>
                          <span>&nbsp;грн</span>
                        </p>
                      </li>
                    </ul>
                  </div>
                  
                </li>
              ))
          }
        </ul>

        <ul class="price-list">
          {
            devSection &&
              devSection.desc.map((item, itemIndex) => (
                <li class="price-list__item">
                  <h4 class:list={["price-list__item-title", "dev--color"]}>{item.title}</h4>
                  <div class="price-list__item-content">
                    <div class:list={["item-content", "dev-content"]}>
                      <p class="item-content__desc">{item.text}</p>

                      {/* Условный рендеринг списка info с утверждением типа */}
                      {(item as any).info && Array.isArray((item as any).info) && (item as any).info.length > 0 ? (
                        <ul class="item-content__list">
                          {(item as any).info.map((infoItem: string, index: number) => (
                            <li>{infoItem}</li>
                          ))}
                        </ul>
                      ) : null}
                    </div>

                    <ul class="item-content__tariff">
                      {/* Условный рендеринг тарифов и стексов. Утверждение типа для stack/price */}
                      {(item as any).stack &&
                        Array.isArray((item as any).stack) &&
                        (item as any).price &&
                        Array.isArray((item as any).price) &&
                        (item as any).stack.map((stackItem: string, index: number) => (
                          <li class="item-content__tariff-item">
                            <p class="tariff-item__dev">{stackItem}</p>
                            <p class="tariff-item__price">
                              <span>від&nbsp;</span>
                              {/* Безопасный доступ к элементу массива price через утверждение типа */}
                              <strong>{(item as any).price[index]}</strong>
                              <span>&nbsp;грн</span>
                            </p>
                          </li>
                        ))}
                    </ul>
                  </div>
                </li>
              ))
          }
        </ul>
      </section>
    </main>
  </div>
</section>

<style>
  .main {
    --margin-main: 40px;
    display: flex;
    flex-direction: column;
    row-gap: var(--margin-main);
    margin-top: var(--margin-main);
  }

  .price {
    padding-top: calc(150px - var(--title-margin-top));
    padding-bottom: 146px;
    background-color: var(--bg-primary);
  }

  .price-header {
    display: flex;
    justify-content: space-between;
    border-bottom: 1px dashed rgba(239, 239, 239, 0.25);
    padding-bottom: 20px;
  }
  .price-header__item {
    display: flex;
    align-items: center;
    column-gap: 24px;
    height: max-content;
  }
  .price-header__item-dev {
    flex-direction: row-reverse;
  }

  .header-item {
    font-family: Lato;
    font-size: 36px;
    font-weight: 600;
    line-height: 43px;
    letter-spacing: 0px;
    text-align: center;
    text-transform: capitalize;
  }

  .header-img {
    object-fit: contain;
  }

  .price-main {
    display: flex;
    justify-content: space-between;
  }

  .price-list {
    max-width: 520px;
    width: 100%;
    display: flex;
    flex-direction: column;
    justify-content: space-between;

    row-gap: 40px;

    background: rgba(41, 40, 57, 1);
    padding: 44px 36px 44px 36px;
  }

  .price-list__item {
    width: 100%;
  }

  .price-list__item-title {
    font-family: Lato;
    font-size: 16px;
    font-weight: 400;
    line-height: 19px;
    letter-spacing: 0px;
    text-align: left;
  }
  .price-list__item-content {
    margin-top: 16px;
    display: flex;
    justify-content: space-between;

    column-gap: var(--gap-base);
  }

  .item-content {
    max-width: 280px;
    color: rgba(76, 73, 94, 1);
    font-family: Lato;
    font-size: 12px;
    font-weight: 400;
    line-height: 14px;
    letter-spacing: 0px;
    text-align: left;
  }

  .item-content__tariff {
    width: max-content;

    display: flex;
    flex-direction: column;
    justify-content: space-between;
    row-gap: var(--gap-base);
  }

  .item-content__tariff-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    column-gap: calc(var(--gap-base) / 2);
  }

  .item-content__tariff-item p {
    text-wrap: nowrap;
  }
  .tariff-item__dev {
    color: rgba(76, 73, 94, 1);
    font-family: Lato;
    font-size: 10px;
    font-weight: 400;
    line-height: 12px;
    letter-spacing: 0px;
    text-align: left;
  }

  .tariff-item__price {
    color: rgba(255, 159, 28, 1);

    font-family: Lato;
    font-size: 15px;
    font-weight: 400;
    line-height: 18px;
    letter-spacing: 0px;
    text-align: left;
  }

  .design--color {
    color: rgba(118, 108, 245, 1);
  }

  .design-content ~ .item-content__tariff {
    align-self: flex-end;
  }

  .dev--color {
    color: rgba(35, 158, 232, 1);
  }
  .dev-content .item-content__desc {
    font-weight: 700;
  }

  .dev-content .item-content__list {
    list-style-type: disc;
    list-style-position: inside;
  }

  .dev-content .item-content__tariff {
    min-width: 170px;
  }
</style>
